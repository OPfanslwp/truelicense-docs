<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Updating Your Project | TrueLicense</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="An open source engine for license management on the JVM">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.9df3e24b.js" as="script"><link rel="preload" href="/assets/js/2.4ccf81c2.js" as="script"><link rel="preload" href="/assets/js/13.4ad99de9.js" as="script"><link rel="prefetch" href="/assets/js/10.0bf9c95b.js"><link rel="prefetch" href="/assets/js/11.0f5eb642.js"><link rel="prefetch" href="/assets/js/12.1654806d.js"><link rel="prefetch" href="/assets/js/14.74c21f40.js"><link rel="prefetch" href="/assets/js/15.26006ba8.js"><link rel="prefetch" href="/assets/js/16.689f8cab.js"><link rel="prefetch" href="/assets/js/17.e8541675.js"><link rel="prefetch" href="/assets/js/18.19edb90c.js"><link rel="prefetch" href="/assets/js/3.9b65aa42.js"><link rel="prefetch" href="/assets/js/4.e4504939.js"><link rel="prefetch" href="/assets/js/5.821dd582.js"><link rel="prefetch" href="/assets/js/6.7ac54f90.js"><link rel="prefetch" href="/assets/js/7.4c0a92e8.js"><link rel="prefetch" href="/assets/js/8.c7065e43.js"><link rel="prefetch" href="/assets/js/9.9de8c945.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">TrueLicense</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/introduction.html" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/reference/config-properties.html" class="nav-link">
  Reference
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/introduction.html" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/reference/config-properties.html" class="nav-link">
  Reference
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/guide/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/guide/getting-started.html" class="sidebar-link">Getting Started</a></li><li><a href="/guide/example-configurations.html" class="sidebar-link">Example Configurations</a></li><li><a href="/guide/project-structure.html" class="sidebar-link">Project Structure</a></li><li><a href="/guide/setting-up-a-vcs.html" class="sidebar-link">Setting Up A VCS</a></li><li><a href="/guide/building-your-project.html" class="sidebar-link">Building Your Project</a></li><li><a href="/guide/using-the-cli.html" class="sidebar-link">Using The CLI</a></li><li><a href="/guide/using-the-wsi.html" class="sidebar-link">Using The WSI</a></li><li><a href="/guide/using-the-api.html" class="sidebar-link">Using the API</a></li><li><a href="/guide/updating-your-project.html" aria-current="page" class="active sidebar-link">Updating Your Project</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/updating-your-project.html#overview" class="sidebar-link">Overview</a></li><li class="sidebar-sub-header"><a href="/guide/updating-your-project.html#limiting-license-key-validity" class="sidebar-link">Limiting License Key Validity</a></li><li class="sidebar-sub-header"><a href="/guide/updating-your-project.html#adding-an-edition" class="sidebar-link">Adding An Edition</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/updating-your-project.html#adding-the-name" class="sidebar-link">Adding The Name</a></li><li class="sidebar-sub-header"><a href="/guide/updating-your-project.html#adding-the-keystore-password" class="sidebar-link">Adding The Keystore Password</a></li><li class="sidebar-sub-header"><a href="/guide/updating-your-project.html#adding-the-encryption-password" class="sidebar-link">Adding The Encryption Password</a></li><li class="sidebar-sub-header"><a href="/guide/updating-your-project.html#amending-the-keystores" class="sidebar-link">Amending The Keystores</a></li></ul></li><li class="sidebar-sub-header"><a href="/guide/updating-your-project.html#upgrading-your-project" class="sidebar-link">Upgrading Your Project</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/updating-your-project.html#generating-your-new-project" class="sidebar-link">Generating Your New Project</a></li><li class="sidebar-sub-header"><a href="/guide/updating-your-project.html#copying-keystores" class="sidebar-link">Copying Keystores</a></li><li class="sidebar-sub-header"><a href="/guide/updating-your-project.html#customizing-properties" class="sidebar-link">Customizing Properties</a></li><li class="sidebar-sub-header"><a href="/guide/updating-your-project.html#building-your-project" class="sidebar-link">Building Your project</a></li></ul></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="updating-your-project"><a href="#updating-your-project" class="header-anchor">#</a> Updating Your Project</h1> <p>This page shows you how to update your project <em>after</em> you have put it into production for selling license keys.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>If you have not put your project into production yet, then you can safely skip this page.
If you just want to change some <a href="/reference/config-properties.html">configuration properties</a>, then you can simply
<a href="/guide/getting-started.html#generating-a-project">regenerate your project</a>.</p></div> <h2 id="overview"><a href="#overview" class="header-anchor">#</a> Overview</h2> <p>In the top-level directory of your generated project, the file <code>pom.xml</code> contains an XML element named <code>properties</code>:</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">[...]</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        [...]
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>This element gets populated when you <a href="/guide/getting-started.html#generating-a-project">generate your project</a>.
Its contents are a list of XML elements of the form <code>&lt;name&gt;value&lt;/name&gt;</code>.
Each element defines a property <code>name</code> and <code>value</code>.
These properties get used for code generation, e.g. there is a property named <code>subject</code> whose value defines the name of
your software product - see below.</p> <div class="custom-block danger"><p class="custom-block-title">WARNING</p> <p>Changing the property values in the file <code>pom.xml</code> may break compatibility with existing license keys!
If you have not already done so, then please <a href="/guide/setting-up-a-vcs.html">set-up a VCS</a> for your project or otherwise make sure
to have some backup before proceeding.</p></div> <h2 id="limiting-license-key-validity"><a href="#limiting-license-key-validity" class="header-anchor">#</a> Limiting License Key Validity</h2> <p>Let’s assume you want to limit the validity of the license keys for your software product to a particular version number
range, e.g. the same major version number.
Then you should include this version number range, e.g. the major version number 1, in the value of the property named
<code>subject</code>:</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>subject</span><span class="token punctuation">&gt;</span></span>Product 1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>subject</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Later, when you want to publish a new major version number release, e.g. major version number 2, then all you need to do
in order to invalidate all previously generated license keys is to update the property value accordingly:</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>subject</span><span class="token punctuation">&gt;</span></span>Product 2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>subject</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>It does not matter how you format the version number range in the licensing subject because the validation function
simply compares the complete string.
So if you like, you could also set the property value to <code>Product 1.x</code> or <code>Product 2.x</code> instead of <code>Product 1</code> or
<code>Product 2</code>, respectively.
If TrueLicense finds an old license key installed then a <code>global.namespace.truelicense.api.LicenseValidationException</code> <a href="/guide/using-the-api.html#verifying-the-license-key">gets thrown by the API</a>.</p> <h2 id="adding-an-edition"><a href="#adding-an-edition" class="header-anchor">#</a> Adding An Edition</h2> <h3 id="adding-the-name"><a href="#adding-the-name" class="header-anchor">#</a> Adding The Name</h3> <p>Let’s assume you want to add another edition to your software product so that you can upsell a different type of
license key for some new features.
The value of the property named <code>editions</code> defines a comma separated list of edition names, ordered from feature
superset to subset.
Each name must be a valid Java identifier and should be camelCased with the initial character being lowercase.</p> <p>The name <code>ftp</code> is reserved for an auto-generated free trial period.
If you didn’t define a value for this property when generating your project, then the default value is <code>standard</code>:</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>editions</span><span class="token punctuation">&gt;</span></span>standard<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>editions</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>You can simply add the name of the new edition to this list (mind the sorting order from feature superset to subset).</p> <p>For example, if you want to sell a higher-priced Enterprise Edition as a superset of the existing Standard Edition,
then you need to insert the name of the enterprise edition <em>before</em> the name of the standard edition:</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>editions</span><span class="token punctuation">&gt;</span></span>enterprise standard<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>editions</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>On the other hand, if you want to sell a lower-priced Lite Edition as a subset of the existing Standard Edition,
then you need to append the name of the lite edition <em>after</em> the name of the standard edition:</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>editions</span><span class="token punctuation">&gt;</span></span>standard lite<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>editions</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="adding-the-keystore-password"><a href="#adding-the-keystore-password" class="header-anchor">#</a> Adding The Keystore Password</h3> <p>For each edition, there needs to be a password for accessing the individual private key for signing the license keys.
If you don’t configure this password, then it defaults to the password for verifying the integrity of the private key
store, which defaults to the password set when generating your project.
You don’t need to change this password at all, but if you want to, then you can do so by adding a property named
<code>${edition}KeyEntryPassword</code>, where you need to replace <code>${edition}</code> with the name of the new edition.
For example, you can add a password for an edition named <code>enterprise</code> like this:</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>enterpriseKeyEntryPassword</span><span class="token punctuation">&gt;</span></span>[...]<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>enterpriseKeyEntryPassword</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>For accessing the entry in the keystore its name needs to be configured, too.
This could simply be the name of the edition, like so:</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>enterpriseKeyEntryAlias</span><span class="token punctuation">&gt;</span></span>enterprise<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>enterpriseKeyEntryAlias</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="adding-the-encryption-password"><a href="#adding-the-encryption-password" class="header-anchor">#</a> Adding The Encryption Password</h3> <p>For each edition, there needs to be a password for encrypting and decrypting the license keys.
If you don’t configure this password, then it defaults to the password set when generating your project.
Again, you don’t need to change this password, but if you want to, then you can do so by adding a property named
<code>${edition}PbePassword</code>, where you need to replace <code>${edition}</code> with the name of the new edition again.
For example, you can add a password for an edition named <code>enterprise</code> like this:</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>enterprisePbePassword</span><span class="token punctuation">&gt;</span></span>[...]<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>enterprisePbePassword</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="amending-the-keystores"><a href="#amending-the-keystores" class="header-anchor">#</a> Amending The Keystores</h3> <p>Next, the private and public key stores need to get updated so that they contain a new entry for the new edition.
This is done automatically when you are building your project for the very first time.
However, when another edition gets added later, this needs to be done manually.
You can do it like this:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>/usr/libexec/java_home -v <span class="token number">1.8</span><span class="token variable">)</span></span> <span class="token comment"># on macOS only</span>
<span class="token function">chmod</span> +x mvnw
./mvnw generate-resources <span class="token punctuation">\</span>
    -Pgenerate-private-key-store <span class="token punctuation">\</span>
    -Pgenerate-public-key-store <span class="token punctuation">\</span>
    -Deditions<span class="token operator">=</span><span class="token variable">${edition}</span>
</code></pre></div><p>… where you need to replace <code>${edition}</code> with the name of the new feature set.
For example, you can update the keystores for an edition named <code>enterprise</code> like this:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>/usr/libexec/java_home -v <span class="token number">1.8</span><span class="token variable">)</span></span> <span class="token comment"># on macOS only</span>
<span class="token function">chmod</span> +x mvnw
./mvnw generate-resources <span class="token punctuation">\</span>
    -Pgenerate-private-key-store <span class="token punctuation">\</span>
    -Pgenerate-public-key-store <span class="token punctuation">\</span>
    -Deditions<span class="token operator">=</span>enterprise
</code></pre></div><h2 id="upgrading-your-project"><a href="#upgrading-your-project" class="header-anchor">#</a> Upgrading Your Project</h2> <p>Let’s assume you want to upgrade your project to benefit from the latest improvements in TrueLicense.
In this case, you need to generate a new project and customize it so that it’s fully compatible with existing license
keys, i.e. it must be possible to share the same license keys between the old and the new project.</p> <h3 id="generating-your-new-project"><a href="#generating-your-new-project" class="header-anchor">#</a> Generating Your New Project</h3> <p>First you need to <a href="/guide/getting-started.html#generating-a-project">generate a new project</a> and set the values of the properties
as explained below.</p> <h4 id="upgrading-from-before-truelicense-maven-archetype-2-4"><a href="#upgrading-from-before-truelicense-maven-archetype-2-4" class="header-anchor">#</a> Upgrading From Before TrueLicense Maven Archetype 2.4</h4> <p>If the old project was generated using the TrueLicense Maven Archetype before version 2.4, then you need to set the
values of the following properties as follows:</p> <dl><dt><code>password</code></dt> <dd><p>Enter the value produced by the obfuscated string field <code>PBE_PASSWORD</code> in the class <code>**.keymgr.LicensingSchema$Lazy</code>.</p></dd> <dt><code>freeTrialPeriod</code></dt> <dd><p>Enter the value of the field <code>FTP_DAYS</code> in the same class.</p></dd> <dt><code>ftpKeyStoreFile</code></dt> <dd><p>Enter <code>ftp.ks</code>.</p></dd> <dt><code>ftpSecretMarkerClass</code></dt> <dd><p>Enter the parameter value of the last call to the method <code>.storeInUserNode([...])</code> in the same class, but without
the <code>.class</code> suffix, e.g. <code>sun.security.provider.Sun</code>.</p></dd> <dt><code>licenseKeyFormat</code></dt> <dd><p>Search for the expression matching the pattern <code>new *ManagementContext(SUBJECT)</code> in the same class and select the
value as follows:</p> <ul><li>For <code>new V1LicenseManagementContext(SUBJECT)</code>, enter <code>V1</code>.</li> <li>For <code>new V2XmlLicenseManagementContext(SUBJECT)</code>, enter <code>V2/XML</code>.</li> <li>For <code>new V2JsonLicenseManagementContext(SUBJECT)</code>, enter <code>V2/JSON</code> (default).</li></ul></dd> <dt><code>subject</code></dt> <dd><p>Enter the value of the field <code>SUBJECT</code> in the same class.</p></dd> <dt><code>package</code></dt> <dd><p>Enter the part of the package name before the <code>keymgr</code> element in the same class.</p></dd> <dt><code>preferencesType</code></dt> <dd><p>Search for the expression matching the pattern <code>storeIn*Node(LicensingSchema.class)</code> and select the value as
follows:</p> <ul><li>For <code>storeInSystemNode(LicensingSchema.class)</code>, enter <code>system</code>.</li> <li>For <code>storeInUserNode(LicensingSchema.class)</code>, enter <code>user</code>.</li></ul></dd></dl> <h4 id="upgrading-from-truelicense-maven-archetype-2-4-or-later"><a href="#upgrading-from-truelicense-maven-archetype-2-4-or-later" class="header-anchor">#</a> Upgrading From TrueLicense Maven Archetype 2.4 Or Later</h4> <p>If the old project was generated using the TrueLicense Maven Archetype version 2.4 or later, then you need to ensure
that the values of the following properties are equal:</p> <ul><li><code>editions</code></li> <li><code>freeTrialPeriod</code></li> <li><code>ftpKeyStoreFile</code></li> <li><code>ftpSecretMarkerClass</code></li> <li><code>keyStoreType</code></li> <li><code>licenseKeyFormat</code></li> <li><code>password</code></li> <li><code>pbeAlgorithm</code></li> <li><code>preferencesType</code></li> <li><code>privateKeyStoreFile</code></li> <li><code>publicKeyStoreFile</code></li> <li><code>subject</code></li></ul> <h3 id="copying-keystores"><a href="#copying-keystores" class="header-anchor">#</a> Copying Keystores</h3> <p>Copy the following files from the old project to the new project:</p> <ul><li><code>keygen/src/main/resources/${privateKeyStoreFile}</code></li> <li><code>keymgr/src/main/resources/${ftpKeyStoreFile}</code></li> <li><code>keymgr/src/main/resources/${publicKeyStoreFile}</code></li></ul> <h3 id="customizing-properties"><a href="#customizing-properties" class="header-anchor">#</a> Customizing Properties</h3> <p>The file <code>pom.xml</code> contains a set of properties with the following name patterns:</p> <ul><li><code>*Alias</code></li> <li><code>*Password</code></li> <li><code>*Type</code></li></ul> <p>… where <code>*</code> matches any prefix.
Please check the comments for each of these properties in the file and edit their values to match the configuration of
the old project.
If the old project was generated using the TrueLicense Maven Archetype before version 2.4, then its generally necessary
to change the value of the properties named <code>*Alias</code> to <code>mykey</code>, which was the default name for a private key entry
or a trusted certificate entry generated by the Java keytool.</p> <h3 id="building-your-project"><a href="#building-your-project" class="header-anchor">#</a> Building Your project</h3> <p>You are now set for <a href="/guide/building-your-project.html">building your project</a> again.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/christian-schlichtherle/truelicense-docs/edit/develop/docs/guide/updating-your-project.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guide/using-the-api.html" class="prev">
        Using the API
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.9df3e24b.js" defer></script><script src="/assets/js/2.4ccf81c2.js" defer></script><script src="/assets/js/13.4ad99de9.js" defer></script>
  </body>
</html>
